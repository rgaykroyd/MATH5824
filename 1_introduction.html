<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH5824 Generalized Linear and Additive Models - 1&nbsp; Non-parametric Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./2_basicdefinitions.html" rel="next">
<link href="./0_preface.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Non-parametric Modelling</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH5824 Generalized Linear and Additive Models</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Weekly schedule</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0_preface.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_introduction.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Non-parametric Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_basicdefinitions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducing Splines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_interpolating.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interpolating Splines</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="toc-section-number">1.1</span>  Motivation</a></li>
  <li><a href="#general-modelling-approaches" id="toc-general-modelling-approaches" class="nav-link" data-scroll-target="#general-modelling-approaches"><span class="toc-section-number">1.2</span>  General modelling approaches</a>
  <ul class="collapse">
  <li><a href="#parametric-models" id="toc-parametric-models" class="nav-link" data-scroll-target="#parametric-models">Parametric models</a></li>
  <li><a href="#non-parametric-models" id="toc-non-parametric-models" class="nav-link" data-scroll-target="#non-parametric-models">Non-parametric models</a></li>
  <li><a href="#piecewise-polynomial-models" id="toc-piecewise-polynomial-models" class="nav-link" data-scroll-target="#piecewise-polynomial-models">Piecewise polynomial models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-nonparametric" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Non-parametric Modelling</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="hidden">
<p><span class="math display">\[
\def\b#1{\mathbf{#1}}
\]</span></p>
</div>
<section id="motivation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">1.1</span> Motivation</h2>
<p><a href="#tbl-coalseemdata">Table&nbsp;<span>1.1</span></a> reports on the depth of a coal seam determined by drilling bore holes at regular intervals along a line. The depth <span class="math inline">\(y\)</span> at location <span class="math inline">\(x=6\)</span> is missing: could we estimate it?</p>
<div id="tbl-coalseemdata" class="anchored">
<table class="table">
<caption>Table&nbsp;1.1: Coal-seam depths (in metres) below the land surface at intervals of 1 km along a linear transect.</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<tbody>
<tr class="odd">
<td>Location, <span class="math inline">\(x\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td>Depth, <span class="math inline">\(y\)</span></td>
<td style="text-align: center;">-90</td>
<td style="text-align: center;">-95</td>
<td style="text-align: center;">-140</td>
<td style="text-align: center;">-120</td>
<td style="text-align: center;">-100</td>
<td style="text-align: center;">-75</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">-130</td>
<td style="text-align: center;">-110</td>
<td style="text-align: center;">-105</td>
<td style="text-align: center;">-50</td>
</tr>
</tbody>
</table>
</div>
<p><a href="#fig-plotCoalseemregress">Figure&nbsp;<span>1.1</span></a> plots these data, superimposed with predictions from several polynomial regression models.</p>
<div id="fig-plotCoalseemregress" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemregress-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemregress-1.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemregress" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Constant model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemregress-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemregress-2.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemregress" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Linear model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemregress-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemregress-3.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemregress" width="672"></p>
<p></p><figcaption class="figure-caption">(c) Quadratic model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemregress-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemregress-4.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemregress" width="672"></p>
<p></p><figcaption class="figure-caption">(d) Cubic model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.1: The coal-seam data superimposed with predictions from polynomial regression models.</figcaption><p></p>
</figure>
</div>
<p>Each of these models would predict a different value for the missing observation <span class="math inline">\(y_6.\)</span> We do not know the accuracy of the depth measurements, so in principle any of these curves could be correct. Clearly, the residual variance is largest for the constant-depth model in <a href="#fig-plotCoalseemregress-1">Figure&nbsp;<span>1.1 (a)</span></a>, and smallest for the cubic polynomial in <a href="#fig-plotCoalseemregress-3">Figure&nbsp;<span>1.1 (c)</span></a>. However, none of these models produces a convincingly good fit. Moreover, these models are not particularly believable, since we know that geological pressures exerted over very long periods of time cause the landscape and its underlying layers of rock to undulate and fracture. This suggests we need a different strategy.</p>
<p>Next, consider the simulated example in <a href="#fig-plotpeicewise">Figure&nbsp;<span>1.2</span></a>. At first look we might be happy with the fitted curves in <a href="#fig-plotpeicewise-1">Figure&nbsp;<span>1.2 (a)</span></a> or <a href="#fig-plotpeicewise-2">Figure&nbsp;<span>1.2 (b)</span></a>. The data, however, are created with a <em>change-point</em> at <span class="math inline">\(x=0.67\)</span> where the relationship changes from linear with slope <span class="math inline">\(0.6\)</span> to a constant value of <span class="math inline">\(0.75\)</span>. This description is completely lost with these two models.</p>
<div id="fig-plotpeicewise" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotpeicewise-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotpeicewise-1.png" class="img-fluid figure-img" data-ref-parent="fig-plotpeicewise" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Linear model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotpeicewise-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotpeicewise-2.png" class="img-fluid figure-img" data-ref-parent="fig-plotpeicewise" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Quadratic model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotpeicewise-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotpeicewise-3.png" class="img-fluid figure-img" data-ref-parent="fig-plotpeicewise" width="672"></p>
<p></p><figcaption class="figure-caption">(c) Piecewise linear model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotpeicewise-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotpeicewise-4.png" class="img-fluid figure-img" data-ref-parent="fig-plotpeicewise" width="672"></p>
<p></p><figcaption class="figure-caption">(d) Cubic smoothing spline</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.2: Simulated data superimposed with predictions from various models.</figcaption><p></p>
</figure>
</div>
<p><a href="#fig-plotpeicewise-3">Figure&nbsp;<span>1.2 (c)</span></a> shows the result of fitting one linear function to the data below <span class="math inline">\(0.67\)</span> and a second linear function above. Clearly, this fits well but it has assumed that the change-point location is known – which is unrealistic. Finally, <a href="#fig-plotpeicewise-4">Figure&nbsp;<span>1.2 (d)</span></a> shows a fitted <em>cubic smoothing spline</em> to the data – we will studies these models later. This shows an excellent fit and leads to appropriate conclusions. That is, the relationship is approximately linear for small values, then there is a rapid increase, and finally a near constant value for high values. Of course, this is not exactly as the true relationship with a discontinuity at <span class="math inline">\(x=0.67\)</span> but it would definitely suggest something extreme occurs between about <span class="math inline">\(0.6\)</span> to <span class="math inline">\(0.7\)</span>. Full details will follow later, but the cubic spline fits local cubic polynomials which are constrained to create a continuous curve.</p>
<p>Now returning to the coal seam data. <a href="#fig-plotCoalseemspline">Figure&nbsp;<span>1.3</span></a> shows the data again, superimposed with predictions from methods which are not constrained to produce such smooth curves.</p>
<div id="fig-plotCoalseemspline" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemspline-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemspline-1.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemspline" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Constant interpolating spline</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemspline-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemspline-2.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemspline" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Linear interpolating spline</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemspline-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemspline-3.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemspline" width="672"></p>
<p></p><figcaption class="figure-caption">(c) Cubic interpolating spline</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-plotCoalseemspline-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="1_introduction_files/figure-html/fig-plotCoalseemspline-4.png" class="img-fluid figure-img" data-ref-parent="fig-plotCoalseemspline" width="672"></p>
<p></p><figcaption class="figure-caption">(d) Cubic smoothing spline</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.3: The coal-seam data superimposed with predictions from various spline models.</figcaption><p></p>
</figure>
</div>
<p>The simplest method, <em>constant-spline interpolation</em>, assumes that the dependent variable remains constant between successive observations, with the result shown in <a href="#fig-plotCoalseemspline-1">Figure&nbsp;<span>1.3 (a)</span></a>. However, the discontinuities in this model make it quite unreliable. A better method, whose results are shown in <a href="#fig-plotCoalseemspline-2">Figure&nbsp;<span>1.3 (b)</span></a>, is <em>linear-spline interpolation</em>, which fits a straight line between successive observations. Even so, this method produces discontinuities in the <em>gradient</em> at each data point. A better method still, shown in <a href="#fig-plotCoalseemspline-3">Figure&nbsp;<span>1.3 (c)</span></a>, is <em>cubic spline interpolation</em>, which fits a cubic polynomial between successive data points such that both the gradient and the curvature at each data point is continuous.</p>
<p>A feature of all these interpolation methods is that they fit the data exactly. Is this a good thing? The final method assumes that there may be some measurement error in the observations, which justifies fitting a smoother cubic spline than the cubic interpolating spline, but as we see in <a href="#fig-plotCoalseemspline-4">Figure&nbsp;<span>1.3 (d)</span></a> which does not reproduce the data points exactly. Is this a bad thing? We will see during this module how to construct and evaluate these curves. Here, the results are presented only for motivation.</p>
</section>
<section id="general-modelling-approaches" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="general-modelling-approaches"><span class="header-section-number">1.2</span> General modelling approaches</h2>
<p>We wish to model the dependence of a response variable <span class="math inline">\(y\)</span> on an explanatory variable <span class="math inline">\(x\)</span>, where <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are both continuous. We observe <span class="math inline">\(y_i\)</span> at each time <span class="math inline">\(x_i,\)</span> for <span class="math inline">\(i=1,\ldots, n\)</span>, where the observation locations are ordered: <span class="math inline">\(x_1 &lt; x_2 &lt; \ldots &lt;x_n\)</span>. We imagine that the <span class="math inline">\(y\)</span>’s are noisy versions of a smooth function of <span class="math inline">\(x\)</span>, say <span class="math inline">\(f(x)\)</span>. That is, <span id="eq-smoothregression"><span class="math display">\[
y_i = f(x_i) + \epsilon_i,
\tag{1.1}\]</span></span> where the <span class="math inline">\(\{\epsilon_i\}\)</span> are i.i.d: <span id="eq-normalerror"><span class="math display">\[
\epsilon_i \sim \mathrm{N}(0,\sigma^2).
\tag{1.2}\]</span></span> We suppose we do not know the correct form of function <span class="math inline">\(f\)</span>: how can we estimate it?</p>
<p>It is useful to divide modelling approaches into two broad types: parametric and non-parametric.</p>
<section id="parametric-models" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="parametric-models">Parametric models</h3>
<p>By far the most common parametric model is simple linear regression, for example, <span class="math inline">\(f(x) = \alpha + \beta x\)</span>, where parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are to be estimated. This is, of course, the simplest example of the polynomial model family, <span class="math inline">\(f(x) = \alpha + \beta x + \gamma x^2 +\cdots + \omega \; x^p\)</span>, where <span class="math inline">\(p\)</span> is the <em>order</em> of the polynomial and where all of <span class="math inline">\(\alpha, \beta, \gamma, \dots, \omega\)</span> are to be estimated. This has as special cases: quadratic, cubic, quartic, and quintic polynomials models. Also common are exponential models, for example <span class="math inline">\(f(x) = \alpha e^{-\beta x}\)</span>, where <span class="math inline">\(\alpha,\beta\)</span> are to be estimated – do not confuse this with the exponential probability density function.</p>
<p>Note that the polynomial models are all linear functions <em>of the parameters</em>. They are standard forms in regression modelling, as studied in MATH3714 (Linear regression and Robustness) and MATH3823 (Generalized linear models). The exponential model, however, is an example of a model which is non-linearly in the parameters – it is an example of a <em>non-linear regression model</em>.</p>
<p>Although very many parametric models exist, they are all somewhat inflexible in their description of <span class="math inline">\(f\)</span>. They cannot accommodate arbitrary fluctuations in <span class="math inline">\(f(x)\)</span> over <span class="math inline">\(x\)</span> because they contain only a small number of parameters (degrees-of-freedom).</p>
</section>
<section id="non-parametric-models" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="non-parametric-models">Non-parametric models</h3>
<p>In such models, <span class="math inline">\(f\)</span> is assumed to be a smooth function of <span class="math inline">\(x\)</span>, but otherwise we do not know what <span class="math inline">\(f\)</span> looks like. A <em>smooth function</em> <span class="math inline">\(f\)</span> is such that <span class="math inline">\(f(x_i)\)</span> is close to <span class="math inline">\(f(x_j)\)</span> whenever <span class="math inline">\(x_i\)</span> is close to <span class="math inline">\(x_j\)</span>. To characterize and fit <span class="math inline">\(f\)</span> we will use an approach based on <em>splines</em>. In practice, different approaches to characterizing and fitting smooth <span class="math inline">\(f\)</span> lead to similar fits to the data. The spline approach fits neatly with normal and generalized linear models (NLMs and GLMs), but so do other approaches (for example, kernel smoothing and wavelets). Methods of fitting <span class="math inline">\(f\)</span> based on kernel smoothing and the Nadaraya–Watson estimator are studied in the Level 5 component of MATH5714 (Linear regression, robustness and smoothing) where the choice of bandwidth in kernel methods is analogous to the choice of smoothing parameter value in spline smoothing.</p>
</section>
<section id="piecewise-polynomial-models" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="piecewise-polynomial-models">Piecewise polynomial models</h3>
<p>A common problem with low-order polynomials is that they can often fit well for part of the data but have unappealing features elsewhere. For example, although none of the models in <a href="#fig-plotCoalseemregress">Figure&nbsp;<span>1.1</span></a> fit the data at all well, we might imagine that three short linear segments might be a good fit to the coal-seam data. Also, the piecewise linear model was a good description of the data in <a href="#fig-plotpeicewise-3">Figure&nbsp;<span>1.2 (c)</span></a>. This suggests that local polynomial models might be useful. In some situation, for example when we know that the function <span class="math inline">\(f\)</span> is continuous, jumps in the fitted model, as in <a href="#fig-plotpeicewise-3">Figure&nbsp;<span>1.2 (c)</span></a>, are unacceptable. Alternatively, we may require differentiability of <span class="math inline">\(f\)</span>. Such technical issues lead to the use of <em>splines,</em> which is introduced in the next chapter.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./0_preface.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Overview</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./2_basicdefinitions.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducing Splines</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>