<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert G Aykroyd">
<meta name="dcterms.date" content="2023-03-13">

<title>MATH5824 Assessed Practical</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="MATH5824 Practical_files/libs/clipboard/clipboard.min.js"></script>
<script src="MATH5824 Practical_files/libs/quarto-html/quarto.js"></script>
<script src="MATH5824 Practical_files/libs/quarto-html/popper.min.js"></script>
<script src="MATH5824 Practical_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MATH5824 Practical_files/libs/quarto-html/anchor.min.js"></script>
<link href="MATH5824 Practical_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MATH5824 Practical_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MATH5824 Practical_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MATH5824 Practical_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MATH5824 Practical_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MATH5824 Assessed Practical</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robert G Aykroyd </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="sec-practicalities" class="level2">
<h2 class="anchored" data-anchor-id="sec-practicalities">Practicalities</h2>
<p>Released on Tuesday 14th March 2023. Practical sessions are planned in the week 20-24 March where you can work on the assessment while I am present to help – check your timetable for the time and location. Note that it is not currently clear if the potential UCU strike action planned over the next few days will affect these Practical Sessions. Please check the module webpage on Minerva for the latest information.</p>
<p>Your task is to fit a suitable model to a data set to investigate how coronary heart disease depends on two explanatory variables (blood pressure and cholesterol) and write a report describing your analysis and conclusion. Some hints are included below to help you carry out the analysis.</p>
<p>Please follow these instructions when writing your report:</p>
<ul>
<li>Your report must start with a short summary explaining your conclusions and interpreting your model in language suitable for a nonspecialist.</li>
<li>Your report must be no longer than eight pages with a <em>standard</em> layout. Put your name, student number, report title, and date of submission at the top of page 1. Do not include a separate title page. Anything on page nine or later will not be marked.</li>
<li>You must include a completed academic integrity form with your submission but that does not count towards the page limit.</li>
<li>Since space is limited, focus your discussions on the essentials and think about what is most important to include in your report. Do not include R code or output in the body of your report, but include your code as a separate appendix (this will not count towards the eight-page limit).</li>
<li>Submit your completed practical report using the links in the <em>Learning Resources / Assessed Practical</em> folder in Minerva by <strong>12 noon on Friday 31st March</strong>. Late work will be penalized by 5% of the available marks for each calendar day, or part day, it is late.</li>
<li>The marking will be done in Gradescope and Turnitin will check for plagiarism. The deadline applies to submission to both Gradescope and Turnitin. That is your submission is only considered on-time if you submit the report to both of Gradescope and Turnitin on-time. If one of them is late, or not submitted at all, then it will considered as a late submission, or as a non-submission.</li>
</ul>
</section>
<section id="sec-background" class="level2">
<h2 class="anchored" data-anchor-id="sec-background">Background</h2>
<p>The table below gives the number (<span class="math inline">\(Y\)</span>) of men diagnosed as having coronary heart disease (CHD) in an American study of 1325 men. The serum cholesterol level (CHOL) and blood pressure (BP) were recorded for each man. Cholesterol values are represented as rows and blood pressure as columns. The variables BP and CHOL are each reported in one of four categories, giving a <span class="math inline">\(4 \times 4\)</span> cross-classified table in which each cell contains the number <span class="math inline">\(Y\)</span> of men with CHD and the number <span class="math inline">\(M\)</span> of men examined. For example, of the 118 men with Normal BP and Normal CHOL, 3 were diagnosed as having coronary heart disease.</p>
<table class="table">
<caption>Results from a study into male coronary heart disease</caption>
<thead>
<tr class="header">
<th><strong>CHOL</strong></th>
<th style="text-align: center;">BP Normal</th>
<th style="text-align: center;">BP Elevated</th>
<th style="text-align: center;">BP Stage I</th>
<th style="text-align: center;">BP Stage II</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Normal</strong></td>
<td style="text-align: center;">3/118</td>
<td style="text-align: center;">4/122</td>
<td style="text-align: center;">3/52</td>
<td style="text-align: center;">4/25</td>
</tr>
<tr class="even">
<td><strong>Medium risk</strong></td>
<td style="text-align: center;">3/89</td>
<td style="text-align: center;">3/102</td>
<td style="text-align: center;">1/41</td>
<td style="text-align: center;">3/24</td>
</tr>
<tr class="odd">
<td><strong>High risk</strong></td>
<td style="text-align: center;">9/126</td>
<td style="text-align: center;">12/219</td>
<td style="text-align: center;">7/73</td>
<td style="text-align: center;">7/48</td>
</tr>
<tr class="even">
<td><strong>Dangerous</strong></td>
<td style="text-align: center;">8/75</td>
<td style="text-align: center;">11/112</td>
<td style="text-align: center;">11/56</td>
<td style="text-align: center;">12/43</td>
</tr>
</tbody>
</table>
<p>These data can be obtained from the <span class="math inline">\(\texttt{chd.txt}\)</span> file which is available online at:</p>
<ul>
<li>rgaykroyd.github.io/MATH3823/Datasets/<em>filename.ext</em> where <em>filename.ext</em> is the stated filename with extension.</li>
</ul>
<p>Note that you may need to explicitly declare as factors any qualitative variables, but you are not expected to declare any as ordered.</p>
</section>
<section id="sec-thetask" class="level2">
<h2 class="anchored" data-anchor-id="sec-thetask">The task</h2>
<p>Fit a suitable model to this dataset to explain how CHD depends on the two explanatory variables. Your final model should balance goodness of fit and model complexity. That is, fit the data well but with relatively few parameters – a parsimonious model.</p>
<p>It may be useful to bear in mind the following considerations when carrying out your analysis:</p>
<ul>
<li>using appropriate plots in an exploratory analysis,</li>
<li>using analysis of deviance tables and residual plots to help choose a suitable model,</li>
<li>combining factor levels when there is little difference between them,</li>
<li>replacing a qualitative factor by a single quantitative variable taking simple values.</li>
</ul>
<p>This is not meant to be an exhaustive list and so you may want to also follow some of your own ideas.</p>
</section>
<section id="sec-rhints" class="level2">
<h2 class="anchored" data-anchor-id="sec-rhints"><strong>R</strong> hints:</h2>
<ul>
<li>If <span class="math inline">\(\texttt{x}\)</span> is a vector in <span class="math inline">\(R\)</span>, then <span class="math inline">\(\texttt{(x==3.4)}\)</span> is a logical vector of the same length as <span class="math inline">\(\texttt{x}\)</span>, which equals <span class="math inline">\(\texttt{TRUE}\)</span> if <span class="math inline">\(\texttt{x=3.4}\)</span> and <span class="math inline">\(\texttt{FALSE}\)</span> otherwise. Other logical vectors include <span class="math inline">\(\texttt{(x&gt;3.4)}\)</span>, <span class="math inline">\(\texttt{(x&gt;=3.4)}\)</span>, <span class="math inline">\(\texttt{(x&lt;3.4)}\)</span>, <span class="math inline">\(\texttt{(x&lt;=3.4)}\)</span>, and <span class="math inline">\(\texttt{(x!=3.4)}\)</span> (for not equal).</li>
<li>When used in arithmetic expressions, logical vectors assume the values 1 when TRUE, and 0 when FALSE.</li>
<li>For example, suppose <span class="math inline">\(\texttt{x}\)</span> is a factor taking the values <span class="math inline">\(\texttt{x=c(1,2,3,4,5)}\)</span>, and suppose we wish to combine levels 3 and 4 together into a new factor with new levels 1, 2, 3, and 4. This can be achieved by defining a vector <span class="math inline">\(\texttt{xnew}\)</span> <span class="math display">\[\begin{align*}
&amp;\texttt{xnew=-1*(x==1)+2*(x==2)+3*(x==3)+ 3*(x==4)+4*(x==5)} \\
&amp;\texttt{new = as.factor(xnew) \# check your result}
\end{align*}\]</span> The second line makes <span class="math inline">\(\texttt{xnew}\)</span> into a factor.</li>
<li>If a factor <span class="math inline">\(\texttt{x}\)</span> takes levels 1:n (consecutive integers starting at 1), it can be turned back into a quantitative variable (i.e.&nbsp;a vector) by the command <span class="math inline">\(\texttt{x = as.numeric(x)}\)</span></li>
<li>If <span class="math inline">\(\texttt{a, x, y}\)</span> are vectors of the same length, a plot of <span class="math inline">\(\texttt{y} vs.\texttt{x}\)</span> labelled by the values of <span class="math inline">\(\texttt{a}\)</span> can be produced by the command <span class="math inline">\(\texttt{plot(x,y,\ pch=as.character(a))}\)</span></li>
</ul>
</section>
<section id="sec-additionallevel5componenttothepractical" class="level2">
<h2 class="anchored" data-anchor-id="sec-additionallevel5componenttothepractical">Additional level 5 component to the practical</h2>
<p>Data were collected from 25 car engines. For each engine, two variables were recorded:</p>
<ul>
<li><span class="math inline">\(\texttt{size}\)</span>: size of engine, and</li>
<li><span class="math inline">\(\texttt{wear}\)</span>: an index of wear.</li>
</ul>
<p>The data file <span class="math inline">\(\texttt{engine.txt}\)</span> is available online at:</p>
<ul>
<li>rgaykroyd.github.io/MATH5824/Datasets/<em>filename.ext</em> where <em>filename.ext</em> is the stated filename with extension.</li>
</ul>
<p>Your task is to plot wear against size and fit some cubic smoothing splines with different values of the smoothing parameter <span class="math inline">\(\lambda\)</span>. You should discuss how the fit changes with the smoothing parameter in terms of visual behaviour and comment briefly on how the fit behaves as the smoothing parameter tends to zero and infinity. Use your judgement to suggest a range of suitable values for the smoothing parameter and suggest which single value you think is best. When investigating different smoothing parameters, it may be helpful to vary <span class="math inline">\(\lambda\)</span> by a factor of 10 between successive fits.</p>
<p>The written version should be about <strong>two or three pages</strong>, plus your <strong>R</strong> code included as an appendix. Please write this up as a separate report from your Level 3 report, and submit it separately on Minerva by the same deadline as the Level 3 part, <strong>12 noon on Friday 31st March</strong> (there will be separate links to submit this report).</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>